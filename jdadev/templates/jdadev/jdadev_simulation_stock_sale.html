{% extends 'jdadev/reloads/jdadev_portfolio_management_home_overall_portfolio.html' %}
{% load i18n %}
{% load crispy_forms_tags %}
{% block assets %}

<style>
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        .header .title {
            flex-grow: 1;
            text-align: center;
        }
        .header .dropdown {
            margin-left: auto;
            background-color: #D5D8DC;/*#3ec1d5;*/
            color: #ffffff;
            border-radius: 5px;
        }

        .dropdown-item:hover {
            background-color: #3ec1d5; /* Change this to your desired color */
            color: #fff; /* Change this to your desired text color */
        }

</style>
<style>
    .centered-input {
        text-align: center;
    }
</style>
{% include 'jdadev/jdadev_simulation_breadcrumbs.html' %}
<div class="card shadow-sm p-2 mb-3 bg-white rounded">
    <div class="card-header">
        <div class="header">
            <div class="title">
                <h6 class="text-muted"><i class="fa fa-briefcase my_info_txt" aria-hidden="true"></i> {% trans 'Stock Sale' %}</h6>
            </div>
        </div>
    </div>

    <div class="card-body">

        <table id="res" class="table table-responsive-sm table-striped table-bordered dt-responsive nowrap" style="width:100%">
            <thead>
            <tr>
                <td><strong>Portfolio Balance Amount: <span class="text-info">{{portfolio_balance|floatformat:2}}</span></strong></td>
            </tr>
            <tr>
                <th>Stocks</th>
                <th>Number of Shares</th>
                <th>Market Price</th>
                <th>Target Price</th>
                <th>Growth Potential</th>
                <th>Total Current Value</th>
                <th>% To Be Sold</th>
                <th># of Sell Share</th>
                <th>Sale Proceeds</th>
                <th>Net Selling Price</th>
                <th>Net Sale Proceeds</th>
            </tr>
            </thead>
            <tbody id="stock-columns">
            {% for i in stock_sold_rpt %}
            <tr>
                <td>{{i.ticker}}</td>
                <td>{{i.number_of_share}}</td>
                <td>{{i.daily_value}}</td>
                <td>{{i.target_value}}</td>
                <td>{{i.gp|floatformat:2}}</td>
                <td>{{i.total_current_value}}</td>
                <td>{{i.percentage_sold}}</td>
                <td>{{i.nbr_shares_sold}}</td>
                <td>{{i.sold_amount}}</td>
                <td>{{i.net_sell_price}}</td>
                <td>{{i.net_sale_proceeds}}</td>

            </tr>
            {% endfor %}
            {% if workflow_bs == 'Stock Sale' %}

            <tr>
                <td colspan="10">
                    <a
                            hx-post="{% url 'jdadev_simulation_confirm_stock_sold' %}"
                            hx-confirm="Are you sure you want to confirm this stock sale?"
                            hx-redirect="{% url 'jdadev_simulation_stock_sold' %}"
                            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                            class="btn btn-success btn-sm text-white">
                        Confirm Stock Sale
                    </a>
                </td>
            </tr>

            {% else %}

            <tr>
                <td colspan="10"><a href="{% url 'jdadev_simulation_bond_sale' %}" class="btn btn-info btn-sm">Sale Bonds <i class="fas fa-arrow-right"></i></a></td>
            </tr>
            {% endif %}

            </tbody>
        </table>
        <!--div id="sale-result" class="mt-2">
            < Confirmation result will be injected here ->
        </div-->
    </div>
    <div class="card-footer text-muted">

        <small id="bank_waiter">As of {% now "Y-m-d" %}</small>
    </div>
</div>

<script>
  document.body.addEventListener('htmx:afterRequest', function(evt) {
    if (evt.detail.xhr.getResponseHeader("HX-Redirect")) {
      window.location.href = evt.detail.xhr.getResponseHeader("HX-Redirect");
    }
  });
</script>


{% endblock %}



